

# 概述

定义

    R-B Tree，(Red-Black Tree，又称为“红黑树”)，
    是
    使用2-3树逻辑
    自平衡的
    的二叉查找树。
    平衡二叉B树


# 红黑树 VS 2-3-4 树

2-3-4 树是紅黑树结构的一种等同，这意味着它们是等价的数据结构

基本思想：

    红黑树的思想就是对2-3查找树进行编码，
    尤其是对2-3查找树中的3-nodes节点添加额外的信息。
    红黑树中将节点之间的链接分为两种不同类型，
    红色链接，他用来链接两个2-nodes节点来表示一个3-nodes节点。
    黑色链接用来链接普通的2-3节点。
    特别的，使用红色链接的两个2-nodes来表示一个3-nodes节点，并且向左倾斜，即一个2-node是另一个2-node的左子节点。
    这种做法的好处是查找的时候不用做任何修改，和普通的二叉查找树相同。
分析

    红黑树的性质：整个树完全黑色平衡，即从根节点到所以叶子结点的路径上，黑色链接的个数都相同（2-3树的第2）性质，从根节点到叶子节点的距离都相等）
    复杂度分析：最坏的情况就是，红黑树中除了最左侧路径全部是由3-node节点组成，即红黑相间的路径长度是全黑路径长度的2倍。

图例

![这里写图片描述](http://img.blog.csdn.net/20180309171011375?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcm9kX2pvaG4=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
# 特性

特点

	1、每个节点都只能是红色或者黑色
	2、根节点是黑色
	3、每个叶节点（NIL节点，空节点）是黑色的。
	4、任一条路径上不能出现相邻的两个红色结点。
	5、从任一节点到叶结点树尾端NIL指针的每条路径都包含相同数目的黑结点。
    红色节点向左倾斜

       红色节点和连线       


# 平衡化手段



旋转

    左旋操作用于将一个向右倾斜的红色链接旋转为向左链接。
    将红线链接的两个节点中的一个较大的节点移动到根节点上。
    同时将


颜色反转
    
    当出现一个临时的4-node的时候，即一个节点的两个子节点均为红色，
    这其实是个A，E，S 4-node连接，我们需要将E提升至父节点，
    把E对子节点的连线设置为黑色，自己的颜色设置为红色。


# 5. 插入

## 5.1 为根节点

	若新插入的节点N没有父节点，则直接当做根据节点插入即可，同时将颜色设置为黑色

## 5.2 往2-node节点插入(父节点为黑色)

动作

	插入为红色节点
	rotate
原理	
	
	将2节点转为3节点
	否则,到达叶节点经过的黑色节点数不一致

## 5.3 往3-node节点插入(父节点为红色,叔父节点U为黑色或者缺少)

## 5.3.1 N为父节点P左孩子,P为爷节点G左孩子

动作

    插入红色
	交换NP颜色
	G右旋

原理

    不能有两个相邻的红色节点
    	
	
![这里写图片描述](http://img.blog.csdn.net/20171216153017763?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcm9kX2pvaG4=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

## 5.3.2 N为P节点的右孩子,P为爷节点G左孩子

动作

    插入红色
	P左旋.
	并交换NP节点的颜色
	
原理
    
    转化为上面的情况	

![这里写图片描述](http://img.blog.csdn.net/20171216152823444?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcm9kX2pvaG4=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)





## 5.4 往4-node节点插入(父节点P和P的兄弟节点U都为红色)


![这里写图片描述](http://img.blog.csdn.net/20171216152031155?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcm9kX2pvaG4=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

动作
	
	红色插入
	P、U节点变黑、G节点变红。
	这时由于经过节点P、U的路径都必须经过G所以在这些路径上面的黑节点数目还是相同的。
	但是经过上面的处理，可能G节点的父节点也是红色，这个时候我们需要将G节点当做新增节点递归处理。
原理
    
    拆分临时5节点

## 5.5 汇总图

![这里写图片描述](http://img.blog.csdn.net/20171216153236223?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcm9kX2pvaG4=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

# 6. 删除

## 6.1  无子节点
       
     直接删除即可，不会影响树的结构。
      
## 6.2  有一个子节点
        
     用子节点替代待删除节点，然后删除子节点即可
     
## 6.2  有两个子节点
        
     用子节点替代待删除节点，然后删除子节点即可


## 被删除的D节点为红色

![这里写图片描述](http://img.blog.csdn.net/20171216162114909?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcm9kX2pvaG4=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

	因为D为红色，所以P必为黑色，同时DR不可能为红色(否则违反性质4)。同时由于性质5，则DR必为Nil，否则就D树来说，经过DR与不经过DR的路径的黑节点数必不相同。现在要删除D节点，只需要直接将D节点删除，并将DR作为P的左子节点即可。

       红黑树删除节点同样会分成几种情况，这里是按照待删除节点有几个儿子的情况来进行分类：

       1、没有儿子，即为叶结点。直接把父结点的对应儿子指针设为NULL，删除儿子结点就OK了。

       2、只有一个儿子。那么把父结点的相应儿子指针指向儿子的独生子，删除儿子结点也OK了。

       3、有两个儿子。这种情况比较复杂，但还是比较简单。上面提到过用子节点C替代代替待删除节点D，然后删除子节点C即可。
       
    针对于红黑树的增加节点而言，删除显得更加复杂，使原本就复杂的红黑树变得更加复杂。同时删除节点和增加节点一样，同样是找到删除的节点，删除之后调整红黑树。但是这里的删除节点并不是直接删除，而是通过走了“弯路”通过一种捷径来删除的：找到被删除的节点D的子节点C，用C来替代D，不是直接删除D，因为D被C替代了，直接删除C即可。所以这里就将删除父节点D的事情转变为了删除子节点C的事情，这样处理就将复杂的删除事件简单化了。子节点C的规则是：右分支最左边，或者 左分支最右边的。
    
       


# 示例

    Java中的java.util.TreeMap,java.util.TreeSet；


#参考
